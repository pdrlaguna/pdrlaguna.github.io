
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Pokémon Game</title>

</head>

<body>
    <textarea id="output-textbox" rows="30" cols="150">Esse é só um teste de lógica e gameplay. No momento o jogo não tem final e o texto aparece todo ao mesmo tempo, o que acaba deixando tudo meio mecânico, mas serve como teste. &#13; &#13;Digite start para começar.&#13;&#13;</textarea>
    <form onSubmit="sendInput(); return false;">
        <input id="input-textbox" type="text" />
        <input type="submit" />
    </form>

<script>

var textIn  = document.getElementById("input-textbox");
var textOut = document.getElementById("output-textbox");

function sendInput() {
    var input = textIn.value;
    textIn.value = "";
    var output = process(input);
    textOut.value += output + "\n";
}
var pikachuHp = 10;
var charmanderHp = 10;


function process(input) {

    if (input === "pika") {
        pikachuHp = pikachuHp;
        return pikachuHp  
    }

    if (input === "char") {
        charmanderHp = charmanderHp;
        return charmanderHp  
    } 

    if (input === "start") { 
        return  "Você estava no Code Academy aprendendo a programar em Javascript e do nada um wild charmander apareceu!"
                +"\n"   
                +"\n"
                +"Você vai batalhar ou fugir?"   
                +"\n";
    } 

    if (input === "batalhar") {
        return   "Ao ver o pobre Charmander indefeso você não perdoa e vai cagá-lo a pau imediatamente!"
                +"\n" 
                +"A batalha começou! Você só tem um Pikachu, então vai ter que ser esse mesmo!" 
                +"\n"   
                +"Seu Pikachu tem 10 de HP." 
                +"\n" 
                +"Como você pegou o Charmander de surpresa indefeso na floresta, você ataca primeiro." 
                +"\n"+"\n" 
                +"Golpes do Pikachu: thundershock" 
                +"\n"; 
    } 

    if (input === "fugir") {
        return   "Você tenta fugir, mas o Charmander te pega mesmo assim e te chama pra briga!"
                +"\n" 
                +"A batalha começou! Você só tem um Pikachu, então vai ter que ser esse mesmo!" 
                +"\n" 
                +"Seu Pikachu tem 10 de HP." 
                +"\n" 
                +"Como você ficou mosqueando distraído na floresta, o Charmander selvagem começou atacando."
                +"\n"+"\n" 
                +ember() 
                +"\n" 
                +"Agora é sua vez. Vê se acorda pra vida e faz alguma coisa!" 
                +"\n"+"\n" 
                +"Golpes do Pikachu: thundershock" 
                +"\n"; 
    } 

    if (input === "thundershock") {
        return  thundershock() 
                +"\n" 
                +ember()  
                +"\n"+"\n" 
                +"Golpes do Pikachu: thundershock" 
                +"\n"; 
    }
}

function thundershock() {
    var diceRoll = Math.random();
    var damage = 0;
    var efetividade = "";

    if (diceRoll < 0.20) {
        efetividade = "é super efetivo!";
        var damage = 4;
    } else if (diceRoll <= 0.60) {
        efetividade = "é bem efetivo.";
        var damage = 2;
    } else if (diceRoll <= 0.95) {
        efetividade = "pegou de raspão.";
        var damage = 1;
    } else {
        efetividade = "errou.";
        var damage = 0;
    }

    charmanderHp = charmanderHp - damage;

    return "Pikachu usa Thundershock e " + efetividade 
           +"\n"
           +"Charmander perde " + damage + " de HP."  
           +"\n" 
           +"Charmander tem " + charmanderHp + " de HP."
}

function ember() {
    var diceRoll = Math.random();
    var damage = 0;
    var efetividade = "";

    if (diceRoll < 0.20) {
        efetividade = "é super efetivo!";
        var damage = 4;
    } else if (diceRoll <= 0.60) {
        efetividade = "é bem efetivo.";
        var damage = 2;
    } else if (diceRoll <= 0.95) {
        efetividade = "pegou de raspão.";
        var damage = 1;
    } else {
        efetividade = "errou.";
        var damage = 0;
    }

    pikachuHp = pikachuHp - damage;

    return "Charmander usa Ember e " + efetividade 
           +"\n"
           +"Pikachu perde " + damage + " de HP."  
           +"\n" 
           +"Pikachu tem " + pikachuHp + " de HP."
}

</script>
</body>
</html>